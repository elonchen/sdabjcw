extends ../../../layouts/admin

block head
  title 人员管理 / 详细

block neck
  link(rel='stylesheet', href='/views/admin/accounts/details.min.css?#{cacheBreaker}')

block feet
  script(src='/views/admin/accounts/details.min.js?#{cacheBreaker}')

block body
  div.row
    div.col-xs-12
      div#header
  div.row
    div.col-sm-8
      div#details
      div#login
      div#delete
    div.col-sm-4
      fieldset
        div#status-new.status-new
        div#status-collection
      fieldset
        div#notes-new.notes-new
        div#notes-collection

  script(type='text/template', id='tmpl-header')
    div.page-header
      h1
        a(href='/admin/accounts/') 帐号
        |  / <%- name.full %>

  script(type='text/template', id='tmpl-details')
    fieldset
      legend 个人资料
      div.alerts
        |<% _.each(errors, function(err) { %>
        div.alert.alert-danger.alert-dismissable
          |<%- err %>
        |<% }); %>
        |<% if (success) { %>
        div.alert.alert-info.alert-dismissable
          button.close(type='button', data-dismiss='alert') &times;
          | 更改成功
        |<% } %>
      div.form-group(class!='<%- errfor.first ? "has-error" : "" %>')
        label 姓名:
        input.form-control(type='text', name='first', value!='<%- first %>')
        span.help-block <%- errfor.first %>
      div.form-group(class!='<%- errfor.middle ? "has-error" : "" %>')
        label 分队:
        select.form-control(name='middle' value!='<%- zip %>')
          option(value='1分队') 1分队
          option(value='2分队') 2分队
          option(value='3分队') 3分队
          option(value='4分队') 4分队
          option(value='5分队') 5分队
          option(value='6分队') 6分队
          option(value='维修支持') 维修支持
          option(value='其他') 其他
        //input.form-control(type='text', name='middle', value!='<%- middle %>')
        span.help-block <%- errfor.middle %>
      div.form-group(class!='<%- errfor.last ? "has-error" : "" %>')
        label 公司聘任岗位:
        select.form-control(name='last' value!='<%- zip %>')
          option(value='一级技术员') 一级技术员
          option(value='二级技术员') 二级技术员
          option(value='高级技术员') 高级技术员
          option(value='检验工程师') 检验工程师
          option(value='排故工程师') 排故工程师
          option(value='高级排故工程师') 高级排故工程师
          option(value='维修保障员') 维修保障员
          option(value='一级特种车司机') 一级特种车司机
          option(value='二级特种车司机') 二级特种车司机
          option(value='三级维修勤务员（特车）') 三级维修勤务员（特车）
          option(value='中级维修调度管理员') 中级维修调度管理员
          option(value='北京维修基地航线中队副中队长') 北京维修基地航线中队副中队长
          option(value='北京维修基地副经理兼北京维修基地航线中队') 北京维修基地副经理兼北京维修基地航线中队
          option(value='综合业务助理') 综合业务助理
          option(value='其他') 其他
        //input.form-control(type='text', name='last', value!='<%- last %>')
        span.help-block <%- errfor['last'] %>
      div.form-group(class!='<%- errfor.company ? "has-error" : "" %>')
        label 岗位级别:
        select.form-control(name='company' value!='<%- zip %>')
          option(value='初级') 初级
          option(value='中级') 中级
          option(value='高级') 高级
          option(value='管理') 管理
        //input.form-control(type='text', name='company', value!='<%- company %>')
        span.help-block <%- errfor.company %>
      div.form-group(class!='<%- errfor.phone ? "has-error" : "" %>')
        label 员工号:
        input.form-control(type='text', name='phone', value!='<%- phone %>')
        span.help-block <%- errfor.phone %>
      div.form-group(class!='<%- errfor.zip ? "has-error" : "" %>')
        label 评测角色:
        select.form-control(name='zip' value!='<%- zip %>')
          option(value='航线中级岗及以下') 航线中级岗及以下
          option(value='维修支持中级岗及以下') 维修支持中级岗及以下
          option(value='航线或维修支持主管') 航线或维修支持主管
          option(value='副中队长') 副中队长
          option(value='中队长') 中队长
          option(value='其他') 其他
        //input.form-control(type='text', name='zip', value!='<%- zip %>')
        span.help-block <%- errfor.zip %>
      div.form-group
        button.btn.btn-primary.btn-update(type='button') 更改

  script(type='text/template', id='tmpl-login')
    fieldset
      legend 登录信息
      div.alerts
        |<% _.each(errors, function(err) { %>
        div.alert.alert-danger.alert-dismissable
          button.close(type='button', data-dismiss='alert') &times;
          |<%- err %>
        |<% }); %>
      div.form-group(class!='<%- errfor.newUsername ? "has-error" : "" %>')
        label Username:
        div.input-group
          |<% if (name) { %>
          input.form-control(disabled=true, value!='<%= name %>')
          div.input-group-btn
            button.btn.btn-warning.btn-user-unlink(type='button') Unlink
            button.btn.btn-default.btn-user-open(type='button') Open
          |<% } else { %>
          input.form-control(name='newUsername', type='text', placeholder='enter a username')
          div.input-group-btn
            button.btn.btn-success.btn-user-link(type='button') Link
          |<% } %>
        span.help-block <%- errfor.newUsername %>

  script(type='text/template', id='tmpl-status-new')
    legend Status
    div.alerts
      |<% _.each(errors, function(err) { %>
      div.alert.alert-danger.alert-dismissable
        button.close(type='button', data-dismiss='alert') &times;
        |<%- err %>
      |<% }); %>
    div.input-group
      select.form-control(name='status')
        option(value='') -- choose --
        for status in data.statuses
          option(value='#{status._id}') #{status.name}
      div.input-group-btn
        button.btn.btn-default.btn-add Change

  script(type='text/template', id='tmpl-status-collection')
    div#status-items.status-items

  script(type='text/template', id='tmpl-status-item')
    div.pull-right.badge.author
      |<%= userCreated.name %>
      | -&nbsp;
      span.timeago <%= userCreated.time %>
    div <%- name %>
    div.clearfix

  script(type='text/template', id='tmpl-notes-new')
    legend Notes
    div.alerts
      |<% _.each(errors, function(err) { %>
      div.alert.alert-danger.alert-dismissable
        button.close(type='button', data-dismiss='alert') &times;
        |<%- err %>
      |<% }); %>
    textarea.form-control(rows='3', name='data', placeholder='enter notes')
    button.btn.btn-default.btn-block.btn-add Add New Note

  script(type='text/template', id='tmpl-notes-collection')
    div#notes-items.notes-items

  script(type='text/template', id='tmpl-notes-item')
    div.force-wrap <%- data %>
    div.pull-right.badge.author
      |<%= userCreated.name %>
      | -&nbsp;
      span.timeago <%= userCreated.time %>
    div.clearfix

  script(type='text/template', id='tmpl-notes-none')
    div.note.text-muted no notes found

  script(type='text/template', id='tmpl-delete')
    fieldset
      legend Danger Zone
      div.alerts
        |<% _.each(errors, function(err) { %>
        div.alert.alert-danger.alert-dismissable
          button.close(type='button', data-dismiss='alert') &times;
          |<%- err %>
        |<% }); %>
      div.form-group
        span.help-block
          span.label.label-danger If you do this, it cannot be undone.
          |&nbsp;
          span.text-muted You may also create orphaned document relationships too.
      div.form-group
        button.btn.btn-danger.btn-delete(type='button') Delete

  script(type='text/template', id='data-record') !{data.record}
